% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vs_sov.R
\name{vs_sov}
\alias{vs_sov}
\title{Vote-Specific Shapley-Owen Values}
\usage{
vs_sov(
  estimates = NULL,
  weight_nom = FALSE,
  absolute = FALSE,
  vw = NULL,
  q = NULL,
  pr = 0.5001,
  votes = NULL,
  dec = 3,
  out_dir = "output",
  print_results = FALSE
)
}
\arguments{
\item{estimates}{Estimation results from oc, wnom, or mcmcPack.}

\item{weight_nom}{If TRUE use weights estimated from wnom output, if FALSE use vector of 1's. ... For wnom only.}

\item{absolute}{If TRUE, q is a scalar of yeas needed to pass proposal.  If FALSE, pr is the proportion of yeas need to pass a proposal among voters attending.}

\item{vw}{Vector of weights for each voter (default 1 for each member, applied later).}

\item{q}{The quota of yeas need to pass a proposal under absolute k-majority rule (scalar, default absolute.maj(vw) applied later ).}

\item{pr}{The proportion of yea votes needed to pass a proposal among voters attending for simple k-majority rule (scalar, default: 0.5001).}

\item{votes}{Vote matrix (legislators x rollcalls) coded yea=1, nay=0, and 9="attend but abstain".  All other values should be NA.}

\item{dec}{The number of decimal places reported for vs-sovs.}

\item{out_dir}{The path to the output directory. If print_results = TRUE, the default is a subdirectory of the current path called "output", which the program creates.}

\item{print_results}{If TRUE, print results to an excel file in out_dir; if FALSE, don't print results.  In both cases, results are returned.}
}
\value{
A list with data frames containing ideal points, vs-SOVs for each voter, number of pivots, name of pivot(s) for each roll call, and normal vectors and angles for each roll call.
}
\description{
This function calculates vote-specific Shapley-Owen values (vs-SOVs) from package estimated inputs.
}
\examples{
# VS-SOVs in 2D using W-NOMINATE OUTPUT
# vs_sov() needs an "estimates" object from OC, WNOMINATE, or MCMCpack.
# Below is a minimal WNOMINATE-like object built from 2D ideals
# and three roll calls.

# Ideals: 5 voters in 2D
i1 <- c( 0.7,  0.7)
i2 <- c(-0.5,  0.5)
i3 <- c(-0.7, -0.7)
i4 <- c( 0.5, -0.5)
i5 <- c( 0.0,  0.0)
ideals <- rbind(i1, i2, i3, i4, i5)
rownames(ideals) <- paste0("i", 1:5)
colnames(ideals) <- c("coord1D","coord2D")

# Fabricate a minimal WNOM-like object called estimates
# Spreads pick the normal directions; midpoints place the cutplane.
spreads <- rbind(
  c( 1,  0),  # RC1: normal along +x
  c( 0,  1),  # RC2: normal along +y
  c(-1,  0)   # RC3: normal along -x
)
midpoints <- rbind(
  c( 0.10,  0.00),  # RC1 cut near the origin on x
  c( 0.00, -0.10),  # RC2 cut slightly below origin on y
  c( 0.05,  0.00)   # RC3 cut near the origin on x
)
rownames(spreads)  <- rownames(midpoints) <- paste0("RC", 1:3)

# Legislators must include coord1D/coord2D plus GMP and CC fields.
# These help the function identify the type of estimate.
leg <- data.frame(
  coord1D = ideals[, 1],
  coord2D = ideals[, 2],
  GMP = 0.5,
  CC  = 0.5,
  row.names = rownames(ideals),
  check.names = FALSE
)

# Roll calls must include GMP and the WNOM fields midpoint\*D and spread\*D.
rc <- data.frame(
  GMP = rep(0.5, nrow(midpoints)),
  midpoint1D = midpoints[, 1],
  midpoint2D = midpoints[, 2],
  spread1D   = spreads[, 1],
  spread2D   = spreads[, 2],
  row.names  = rownames(midpoints),
  check.names = FALSE
)

# Dimensional weights (first must be 1); here both dimensions are equal.
weights <- c(1, 1)

# Minimal WNOM-like object
estimates <- list(
  legislators = leg,
  rollcalls   = rc,
  weights     = weights
)
class(estimates) <- "nomObject"  # not required, but reasonable

# Votes: 1=yea, 0=nay, 9=attend-no-vote, NA=absent
votes <- cbind(
  RC1 = c(1, 0, 0, 1, 9),  # include one '9' to illustrate attendance w/o voting
  RC2 = c(1, 1, 0, 0, 0),
  RC3 = c(0, 1, 1, 0, 0)
)
rownames(votes) <- rownames(ideals)

# Equal voting weights
vw <- rep(1, nrow(ideals))

# VS-SOV from WNOM-like estimates (simple majority among attendees)
out_vs <- vs_sov(
  estimates = estimates,
  votes     = votes,
  absolute  = FALSE,  # simple k-majority
  pr        = 0.5001,
  vw        = vw,
  dec       = 3
)

# aggregate results by member
out_vs$pivot_summary
# Pivot names by roll call:
out_vs$pivot_by_rc
# Normals and angles (derived from spreads & midpoints):
out_vs$nv_and_angles

}
